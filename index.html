<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://unpkg.com/popper.js/dist/umd/popper.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-form-validator/2.3.26/jquery.form-validator.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/floatthead/2.1.2/jquery.floatThead.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@2.1.6/dist/loadingoverlay.min.js
"></script>
<script src="components/crmTable.html" type="riot/tag"></script>

<script type="text/javascript" src="https://rawgit.com/riot/riot/master/riot%2Bcompiler.min.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
<link rel="stylesheet" href="styles.css">


<script>
    globalInfo = { tags: {}, items: [] }
    globalView = 'CRM';
    archiveInfo = [];
    archivedTag = {};
    //TO-DO find alternative to this global used id
    lastModified = new Date(0);

    function saveItems() {
        $.post("utils.php", { requestType: "write", records: JSON.stringify(globalInfo), token: new Date().getTime() }, (data) => {
            console.log(data);
        });
    }

    function getTag(i) {
        return globalInfo.tags[i];
    }

    function getTagWithName(name) {
        for (key in globalInfo.tags)
            if (globalInfo.tags[key].name == name)
                return globalInfo.tags[key];

        return undefined;
    }

    function getTagsName(){
        var names = []
        for (key in globalInfo.tags)
            names.push(globalInfo.tags[key].name);
        return names;
    }

    function onlyUnique(value, index, self) {
        return self.indexOf(value) === index;
    }

    function getLastId() {
        if (globalInfo.items.length == 0) return 0;
        return Math.max(...globalInfo.items.map(e => e.id));
    }


    function mapTagsProperty(property){
        var result = [];
        for (var k in globalInfo.tags){
            if (property in globalInfo.tags[k]) {
                result.push(globalInfo.tags[k][property]);
            }
        }

        return result;
    }
</script>

<crmTable showHidden="false"></crmTable>

<script>
    riot.mount('*');
</script>


